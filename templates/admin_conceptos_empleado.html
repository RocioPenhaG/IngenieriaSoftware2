<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Conceptos Puntuales - {{ empleado['nombre'] }}</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="container py-4">

  {# -------- Mensajes flash -------- #}
  {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
      {% for category, message in messages %}
        <div class="alert alert-{{ category }} alert-dismissible fade show" role="alert">
          {{ message }}
          <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>
      {% endfor %}
    {% endif %}
  {% endwith %}
  {# --------------------------------- #}

  <h1>Conceptos Puntuales de {{ empleado['nombre'] }}</h1>

  <div class="mb-3">
    <a href="{{ url_for('crear_concepto_empleado', empleado_id=empleado['id']) }}" class="btn btn-primary">‚ûï Agregar Concepto</a>
    <a href="{{ url_for('listar_empleados') }}" class="btn btn-secondary">‚¨ÖÔ∏è Volver</a>
  </div>

  <table class="table table-bordered">
    <thead class="table-dark">
      <tr>
        <th>ID</th>
        <th>Nombre</th>
        <th>Tipo</th>
        <th>Monto fijo</th>
        <th>Porcentaje</th>
        <th>Acciones</th>
      </tr>
    </thead>
    <tbody>
      {% for c in conceptos %}
      <tr>
        <td>{{ c['id'] }}</td>
        <td>{{ c['nombre'] }}</td>
        <td>{{ c['tipo'] }}</td>
        <td>{{ c['monto_fijo'] or "-" }}</td>
        <td>{{ c['porcentaje'] or "-" }}</td>
        <td class="d-flex gap-2">
          <a href="{{ url_for('editar_concepto_empleado', id=c['id']) }}" class="btn btn-sm btn-warning">‚úèÔ∏è Editar</a>

          <!-- Bot√≥n que abre el modal -->
          <button type="button" class="btn btn-sm btn-danger"
                  data-bs-toggle="modal"
                  data-bs-target="#modalEliminar-{{ c['id'] }}">
            üóëÔ∏è Eliminar
          </button>

          <!-- Modal de confirmaci√≥n -->
          <div class="modal fade" id="modalEliminar-{{ c['id'] }}" tabindex="-1" aria-hidden="true">
            <div class="modal-dialog">
              <div class="modal-content">
                <div class="modal-header">
                  <h5 class="modal-title">Confirmar eliminaci√≥n</h5>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                  ¬øSeguro que deseas eliminar el concepto <strong>{{ c['nombre'] }}</strong>?
                </div>
                <div class="modal-footer">
                  <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                  <form method="post" action="{{ url_for('eliminar_concepto_empleado', id=c['id']) }}">
                    <button type="submit" class="btn btn-danger">Eliminar</button>
                  </form>
                </div>
              </div>
            </div>
          </div>
          <!-- Fin modal -->
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
